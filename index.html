<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Player</title>
    <link rel="icon" type="image/png" href="https://img.icons8.com/nolan/1600/audio-wave.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.min.css"/>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsmediatags/3.9.5/jsmediatags.min.js"></script>

    <!-- Minimal styles used to hide the UI while metadata loads and to style lyrics -->
    <style>
      /* While loading, hide the main UI pieces (keeps layout stable if you want) */
      .player-container.loading .img-container img,
      .player-container.loading h2,
      .player-container.loading h3,
      .player-container.loading .progress-container,
      .player-container.loading .player-controls {
        visibility: hidden;
        opacity: 0;
      }

      /* Simple centered spinner shown while loading */
      .spinner-wrapper {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 140px; /* space for album art area */
      }
      .spinner {
        width: 44px;
        height: 44px;
        border: 4px solid rgba(0,0,0,0.12);
        border-top-color: rgba(0,0,0,0.6);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      @keyframes spin { to { transform: rotate(360deg); } }

      /* Lyrics area (Spotify-like centered current line, faded neighbors) */
      .lyrics-wrapper {
        width: 100%;
        max-height: 220px;
        margin: 12px 0 0;
        overflow: hidden; /* hide overflow; we will scroll inner container */
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .lyrics {
        width: 100%;
        max-height: 220px;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        padding: 8px 12px;
        box-sizing: border-box;
        text-align: center;
      }
      .lyrics-line {
        color: rgba(255,255,255,0.55);
        font-size: 15px;
        line-height: 1.6;
        margin: 8px 0;
        transition: color 160ms linear, transform 160ms linear, font-size 160ms linear;
        will-change: transform, color;
        pointer-events: none;
      }
      .lyrics-line.current {
        color: #ffffff;
        font-size: 18px;
        font-weight: 600;
        transform: scale(1.02);
      }

      /* Hide lyrics wrapper if no lyrics */
      .lyrics-wrapper.hidden { display: none; }
    </style>
</head>
<body>
    <div class="player-container loading" id="player-container">
        <div class="img-container">
            <label for="file-input">
            <img draggable="false" src="https://e-cdns-images.dzcdn.net/images/cover/256d2f17d6dfde632b845e757ac41746/500x500-000000-80-0-0.jpg" alt="Album art" crossorigin="anonymous">
            </label>
            <input id="file-input" type="file" multiple accept="audio/*" hidden/>
        </div>

        <!-- Spinner area placed directly under the image container so it appears while hidden -->
        <div class="spinner-wrapper" id="spinner-wrapper">
          <div class="spinner" aria-hidden="true"></div>
        </div>

        <h2 id="title" aria-live="polite"></h2>
        <h3 id="artist"></h3>
        <!-- Keep audio element with id so script can reference it; no autoplay -->
        <audio id="audio" src="music/2.Abigail - Frankie Cosmos.flac" controls hidden></audio>

        <div class="progress-container" id="progress-container">
            <div class="progress" id="progress"></div>
            <div class="duration-wrapper">
                <span id="current-time">0:00</span>
                <span id="duration">0:00</span>
            </div>
        </div>
        <div class="player-controls">
            <i class="fas fa-backward" id="prev" title="Previous"></i>
            <i class="fas fa-play main-button" id="play" title="Play"></i>
            <i class="fas fa-forward" id="next" title="Next"></i>
        </div>

        <!-- Lyrics (Spotify-style, centered current line) -->
        <div class="lyrics-wrapper hidden" id="lyrics-wrapper">
          <div class="lyrics" id="lyrics" aria-live="polite" aria-atomic="true"></div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/color-thief/2.3.0/color-thief.umd.js"></script>
    <!-- Script -->
    <script src="script.js"></script>
</body>

</html>
