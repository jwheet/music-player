<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Player</title>
    <link rel="icon" type="image/png" href="https://img.icons8.com/nolan/1600/audio-wave.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.min.css"/>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsmediatags/3.9.5/jsmediatags.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/color-thief/2.3.0/color-thief.umd.js"></script>

    <!-- Updated styles: larger lyric viewer, more visible text, hidden scrollbars, fullscreen lyrics -->
    <style>
      /* Keep overall loading hiding behavior */
      .player-container.loading .img-container img,
      .player-container.loading h2,
      .player-container.loading h3,
      .player-container.loading .progress-container,
      .player-container.loading .player-controls {
        visibility: hidden;
        opacity: 0;
      }

      /* Simple centered spinner shown while loading */
      .spinner-wrapper {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 160px;
      }
      .spinner {
        width: 44px;
        height: 44px;
        border: 4px solid rgba(0,0,0,0.12);
        border-top-color: rgba(0,0,0,0.6);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      @keyframes spin { to { transform: rotate(360deg); } }

      /* Hide native scrollbars site-wide but keep scrolling functionality.
         This visually removes scrollbars while allowing inner containers to scroll. */
      html, body {
        height: 100%;
        margin: 0;
        scrollbar-width: none; /* Firefox */
        transition: background 500ms ease;
      }
      html::-webkit-scrollbar, body::-webkit-scrollbar {
        display: none; /* WebKit */
      }

      /* Lyrics area: larger and more readable (Spotify-like centered current line) */
      .lyrics-wrapper {
        width: 100%;
        max-height: 360px; /* increased height */
        margin: 18px 0 0;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 0 12px;
        position: relative;
        border-radius: 12px;
        transition: box-shadow 0.3s ease;
      }
      .lyrics-wrapper:hover {
        box-shadow: 0 0 25px 5px rgba(36, 35, 35, 0.5);
      }
      .lyrics {
        width: 100%;
        max-height: 360px; /* match wrapper height */
        overflow-y: auto; /* allow scrolling, scrollbar is hidden visually */
        -webkit-overflow-scrolling: touch;
        padding: 12px 8px;
        box-sizing: border-box;
        text-align: center;
      }
      /* remove visible scrollbars for lyrics container (covers WebKit and Firefox) */
      .lyrics::-webkit-scrollbar { display: none; width: 0; height: 0; }
      .lyrics { scrollbar-width: none; -ms-overflow-style: none; }

      .lyrics-line {
        color: rgba(255,255,255,0.5);
        font-size: 18px; /* larger base font for readability */
        line-height: 1.9;
        margin: 10px 0;
        transition: color 160ms linear, transform 160ms linear, font-size 160ms linear;
        will-change: transform, color;
        cursor: pointer;
        text-shadow: 0 1px 0 rgba(0,0,0,0.35);
      }
      .lyrics-line:hover {
        color: rgba(255,255,255,0.8);
        transform: translateX(4px);
      }
      .lyrics-line.current {
        color: #ffffff;
        font-size: 22px; /* bigger for current line */
        font-weight: 700;
        transform: scale(1.03);
        text-shadow: 0 2px 6px rgba(0,0,0,0.45);
      }

      /* Fullscreen lyrics button (top-right of lyrics area) */
      .lyrics-controls {
        position: absolute;
        top: 10px;
        right: 12px;
        z-index: 4;
        display: flex;
        gap: 6px;
      }
      .lyrics-controls .btn {
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        padding: 8px 10px;
        color: #fff;
        cursor: pointer;
        font-size: 16px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 36px;
        height: 36px;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      }
      .lyrics-controls .btn:hover {
        background: rgba(255, 255, 255, 0.25);
        box-shadow: 0 0 20px 4px rgba(36, 35, 35, 0.6);
        transform: scale(1.05);
      }

      /* Fullscreen styles (fallback) */
      .lyrics-wrapper.fullscreen-fallback {
        position: fixed;
        inset: 0;
        width: 100%;
        height: 100%;
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 40px 24px;
        box-sizing: border-box;
        background: rgba(0,0,0,0.55);
      }
      .lyrics-wrapper.fullscreen-fallback .lyrics {
        max-height: calc(100% - 20px);
        padding: 24px;
      }

      /* :fullscreen pseudo-class styling when using Fullscreen API */
      .lyrics-wrapper:-webkit-full-screen,
      .lyrics-wrapper:-moz-full-screen,
      .lyrics-wrapper:-ms-fullscreen,
      .lyrics-wrapper:fullscreen {
        width: 100%;
        height: 100%;
        padding: 40px 24px;
        box-sizing: border-box;
        background: rgba(0,0,0,0.55);
      }
      .lyrics-wrapper:fullscreen .lyrics {
        max-height: calc(100% - 20px);
        padding: 24px;
      }

      /* Make sure the lyrics area is hidden entirely when not used */
      .lyrics-wrapper.hidden { display: none; }

      /* Slightly increase spacing for player controls so lyrics have room */
      .player-controls {
        margin-top: 12px;
      }

      /* Responsive adjustments */
      @media (max-width: 540px) {
        .lyrics-wrapper { max-height: 260px; margin-top: 12px; }
        .lyrics-line { font-size: 16px; line-height: 1.8; }
        .lyrics-line.current { font-size: 20px; }
      }
    </style>
</head>
<body>
    <div class="player-container loading" id="player-container">
        <div class="img-container">
            <label for="file-input">
            <img draggable="false" id="cover-img" src="https://e-cdns-images.dzcdn.net/images/cover/256d2f17d6dfde632b845e757ac41746/500x500-000000-80-0-0.jpg" alt="Album art" crossorigin="anonymous">
            </label>
            <input id="file-input" type="file" multiple accept="audio/*" hidden/>
        </div>

        <!-- Spinner area placed directly under the image container so it appears while hidden -->
        <div class="spinner-wrapper" id="spinner-wrapper">
          <div class="spinner" aria-hidden="true"></div>
        </div>

        <h2 id="title" aria-live="polite"></h2>
        <h3 id="artist"></h3>
        <!-- Keep audio element with id so script can reference it; no autoplay -->
        <audio id="audio" src="music/2.Abigail - Frankie Cosmos.flac" controls hidden></audio>

        <div class="progress-container" id="progress-container" aria-hidden="false">
            <div class="progress" id="progress"></div>
            <div class="duration-wrapper">
                <span id="current-time">0:00</span>
                <span id="duration">0:00</span>
            </div>
        </div>
        <div class="player-controls">
            <i class="fas fa-backward" id="prev" title="Previous"></i>
            <i class="fas fa-play main-button" id="play" title="Play"></i>
            <i class="fas fa-forward" id="next" title="Next"></i>
        </div>

        <!-- Lyrics (Spotify-style, centered current line) -->
        <div class="lyrics-wrapper hidden" id="lyrics-wrapper">
          <div class="lyrics-controls" aria-hidden="false">
            <div id="lyrics-fullscreen-btn" class="btn" title="Toggle lyrics fullscreen" role="button" aria-pressed="false">
              <i id="lyrics-fullscreen-icon" class="fas fa-expand"></i>
            </div>
          </div>
          <div class="lyrics" id="lyrics" aria-live="polite" aria-atomic="true"></div>
        </div>
    </div>

    <!-- Script -->
    <script src="script.js"></script>
</body>

</html>
